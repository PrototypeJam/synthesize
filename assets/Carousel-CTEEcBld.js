import{r as i,j as e}from"./index-CpsGURV0.js";const R=({data:l,isBusy:w,statusText:k,canShare:E,actions:h})=>{var j;const u=i.useRef(null),[m,b]=i.useState(0),[g,p]=i.useState(null),[d,x]=i.useState(0),y=t=>(t||"").split(`
`).map(s=>s.trim()).filter(Boolean).map((s,a)=>s.startsWith("•")?e.jsx("li",{className:"list-disc ml-5 mb-1",children:s.replace(/^•\s?/,"")},a):e.jsx("p",{className:"mb-1",children:s},a)),f=i.useMemo(()=>{const t=(l.synthesis||"").split(`
`),s=[];let a=null;for(const o of t){const r=o.trim();if(r){if(r.startsWith("## TOPIC FOLLOWS:")||r.startsWith("##")&&!/^##\s*PROVENANCE\b/i.test(r)){a={title:r.replace("## TOPIC FOLLOWS:","").replace(/^##\s*/,"").trim()||"Topic",bullets:[]},s.push(a);continue}(r.startsWith("•")||r.startsWith("- "))&&a&&a.bullets.push(r.replace(/^- /,"•"))}}return s},[l.synthesis]),n=i.useMemo(()=>{const t=[];if((l.summary1||l.summary2)&&t.push(e.jsxs("div",{className:"w-full h-full p-6 md:p-10",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-4",children:"At-a-Glance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.summary1&&e.jsxs("section",{className:"bg-gray-800/60 border border-gray-700 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm uppercase tracking-wide text-blue-300 mb-2",children:"Article"}),e.jsx("div",{className:"text-gray-200 max-h-72 overflow-y-auto pr-2",children:y(l.summary1)})]}),l.summary2&&e.jsxs("section",{className:"bg-gray-800/60 border border-gray-700 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm uppercase tracking-wide text-orange-300 mb-2",children:"HN Discussion"}),e.jsx("div",{className:"text-gray-200 max-h-72 overflow-y-auto pr-2",children:y(l.summary2)})]})]})]},"summaries")),f.forEach((s,a)=>{t.push(e.jsx("div",{className:"w-full h-full p-6 md:p-10",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-800/70 to-gray-900/70 border border-gray-700 rounded-2xl h-full p-6 md:p-8",children:[e.jsx("h3",{className:"text-2xl md:text-4xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-teal-300 to-blue-400",children:s.title}),e.jsx("ul",{className:"text-gray-200 space-y-2 leading-relaxed",children:s.bullets.map((o,r)=>e.jsx("li",{className:"list-disc ml-5",children:o.replace(/^•\s?/,"")},r))})]})},`topic-${a}`))}),(l.synthesis||"").split(`
`).some(s=>/^##\s*PROVENANCE\b/i.test(s))){const s=(l.synthesis||"").split(`
`),a=s.findIndex(r=>/^##\s*PROVENANCE\b/i.test(r)),o=a>=0?s.slice(a+1).filter(r=>r.trim().startsWith("-")):[];o.length&&t.push(e.jsx("div",{className:"w-full h-full p-6 md:p-10",children:e.jsxs("div",{className:"bg-gray-800/60 border border-gray-700 rounded-2xl h-full p-6 md:p-8",children:[e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-100 mb-4",children:"Provenance"}),e.jsx("ul",{className:"text-gray-300 space-y-2",children:o.map((r,v)=>e.jsx("li",{className:"list-disc ml-5",children:r.replace(/^-+\s*/,"")},v))})]})},"prov"))}return t},[l.summary1,l.summary2,f,l.synthesis]),N=t=>Math.max(0,Math.min(n.length-1,t)),c=t=>b(s=>N(s+t)),S=t=>b(N(t));i.useEffect(()=>{const t=s=>{s.key==="ArrowRight"&&c(1),s.key==="ArrowLeft"&&c(-1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[n.length]);const C=t=>{p(t.touches[0].clientX),x(0)},T=t=>{g!==null&&x(t.touches[0].clientX-g)},O=()=>{Math.abs(d)>60&&(d<0?c(1):c(-1)),p(null),x(0)},M=`${Math.min(m+1,Math.max(1,n.length))} of ${Math.max(1,n.length)}`,W=`-${m*100}%`,$=d?`${d/(((j=u.current)==null?void 0:j.clientWidth)||1)*100}%`:"0%";return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[e.jsx("header",{className:"sticky top-0 z-20 backdrop-blur bg-gray-900/70 border-b border-gray-800",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:l.hnTitle?"HN:":"Synthesis"}),e.jsx("h1",{className:"text-base md:text-lg font-semibold truncate max-w-[55vw]",children:l.hnTitle||"Topic Carousel"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[w&&e.jsx("span",{className:"text-xs text-blue-300",children:k}),e.jsx("button",{onClick:h.onDownloadFull,className:"px-3 py-1.5 rounded-lg bg-gray-800 hover:bg-gray-700 border border-gray-700 text-sm",children:"Download"}),E&&e.jsx("button",{onClick:()=>h.onShare("Synthesis",l.synthesis||""),className:"px-3 py-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 text-sm",children:"Share"})]})]})}),e.jsx("main",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{ref:u,className:"relative overflow-hidden h-[calc(100vh-140px)] md:h-[calc(100vh-160px)]",onTouchStart:C,onTouchMove:T,onTouchEnd:O,children:[e.jsxs("div",{className:"flex h-full transition-transform duration-500 ease-in-out",style:{transform:`translateX(calc(${W} + ${$}))`},children:[n.map((t,s)=>e.jsx("div",{className:"min-w-full",children:t},s)),n.length===0&&e.jsx("div",{className:"min-w-full h-full flex items-center justify-center p-8 text-gray-400",children:"No synthesis available. Run a synthesis to view the carousel."})]}),e.jsx("button",{"aria-label":"Previous",onClick:()=>c(-1),className:"absolute left-3 top-1/2 -translate-y-1/2 bg-gray-800/70 hover:bg-gray-700/80 border border-gray-700 rounded-full w-10 h-10 flex items-center justify-center",children:"‹"}),e.jsx("button",{"aria-label":"Next",onClick:()=>c(1),className:"absolute right-3 top-1/2 -translate-y-1/2 bg-gray-800/70 hover:bg-gray-700/80 border border-gray-700 rounded-full w-10 h-10 flex items-center justify-center",children:"›"}),e.jsxs("div",{className:"absolute bottom-4 inset-x-0 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"px-2 py-1 text-xs rounded bg-gray-800/80 border border-gray-700",children:M}),e.jsx("div",{className:"flex gap-2",children:n.map((t,s)=>e.jsx("button",{onClick:()=>S(s),"aria-label":`Go to slide ${s+1}`,className:`w-2.5 h-2.5 rounded-full transition-all ${s===m?"bg-blue-400 w-6":"bg-gray-600 hover:bg-gray-500"}`},s))})]})]})})]})};export{R as default};
