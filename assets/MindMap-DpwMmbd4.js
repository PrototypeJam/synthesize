import{r as g,j as t}from"./index-CQS_ZpxP.js";const P=({data:p,isBusy:k,statusText:C,canShare:S,actions:j})=>{const[u,m]=g.useState(new Set(["center"])),[N,M]=g.useState("center"),O=e=>{m(s=>{const l=new Set(s);return l.has(e)?l.delete(e):l.add(e),l})},w=e=>{M(e),u.has(e)||m(s=>new Set([...s,e]))},{nodes:a,edges:v}=g.useMemo(()=>{const e=(p.synthesis||"").split(`
`),s=[],l=[];s.push({id:"center",label:p.hnTitle||"Synthesis",type:"center",children:[],x:50,y:50});let n=0,i=null,o=0;for(const y of e){const c=y.trim();if(!c)continue;if(c.includes("TOPIC FOLLOWS")||c.startsWith("##")&&!/^##\s*PROVENANCE\b/i.test(c)){n++;let d=c.replace(/^TOPIC FOLLOWS\s*##\s*/i,"").replace(/^##\s*TOPIC FOLLOWS:\s*/i,"").replace(/^TOPIC FOLLOWS:\s*/i,"").replace(/^##\s*/,"").trim();const h=(n-1)*(360/8),x=35,b=50+x*Math.cos(h*Math.PI/180),f=50+x*Math.sin(h*Math.PI/180);i={id:`topic-${n}`,label:d||`Topic ${n}`,type:"topic",children:[],x:b,y:f},s.push(i),s[0].children.push(i.id),l.push({from:"center",to:i.id}),o=0}else if(i&&(c.startsWith("â€¢")||c.startsWith("*")||c.startsWith("-"))){o++;const d=c.replace(/^[â€¢*-]\s*/,"");if(!d)continue;const h=`${i.id}-point-${o}`,x=(o-1)*(360/6),b=15,f=i.x+b*Math.cos(x*Math.PI/180),W=i.y+b*Math.sin(x*Math.PI/180),L={id:h,label:d.substring(0,40)+(d.length>40?"...":""),type:"point",content:d,x:f,y:W};s.push(L),i.children.push(h),l.push({from:i.id,to:h})}}return{nodes:s,edges:l}},[p.synthesis,p.hnTitle]),r=a.find(e=>e.id===N);return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-gray-100",children:[t.jsx("header",{className:"bg-gray-900/80 backdrop-blur border-b border-gray-700 sticky top-0 z-20",children:t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-white",children:"Mind Map"}),k&&t.jsx("p",{className:"text-xs text-blue-400",children:C})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:j.onDownloadFull,className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded text-sm",children:"Download"}),S&&t.jsx("button",{onClick:()=>j.onShare("Mind Map",p.synthesis||""),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 rounded text-sm",children:"Share"})]})]})})}),t.jsxs("div",{className:"flex h-[calc(100vh-4rem)]",children:[t.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[t.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid meet",children:[t.jsx("g",{className:"edges",children:v.map((e,s)=>{const l=a.find(o=>o.id===e.from),n=a.find(o=>o.id===e.to);return!l||!n||!u.has(e.from)?null:t.jsx("line",{x1:l.x,y1:l.y,x2:n.x,y2:n.y,stroke:n.type==="topic"?"#60a5fa":n.type==="point"?"#6ee7b7":"#9ca3af",strokeWidth:"0.2",opacity:"0.5"},s)})}),t.jsx("g",{className:"nodes",children:a.map(e=>{var y;const s=v.find(c=>c.to===e.id);if(!(!s||u.has(s.from)))return null;const n=N===e.id,i=u.has(e.id),o=(((y=e.children)==null?void 0:y.length)||0)>0;return t.jsxs("g",{children:[t.jsx("circle",{cx:e.x,cy:e.y,r:e.type==="center"?5:e.type==="topic"?3:2,fill:e.type==="center"?"#f59e0b":e.type==="topic"?"#3b82f6":"#10b981",stroke:n?"#fff":"none",strokeWidth:n?"0.5":"0",className:"cursor-pointer transition-all",onClick:()=>w(e.id),opacity:n?1:.9}),t.jsx("text",{x:e.x,y:e.y-(e.type==="center"?6:e.type==="topic"?4:3),textAnchor:"middle",fontSize:e.type==="center"?2.5:e.type==="topic"?1.8:1.2,fill:"#fff",className:"pointer-events-none select-none",fontWeight:e.type==="center"?"bold":"normal",children:e.label.substring(0,e.type==="center"?20:e.type==="topic"?15:10)}),o&&t.jsx("circle",{cx:e.x,cy:e.y,r:e.type==="center"?6:3.5,fill:"none",stroke:i?"#10b981":"#6b7280",strokeWidth:"0.3",strokeDasharray:i?"none":"1,0.5",className:"cursor-pointer",onClick:()=>O(e.id),opacity:"0.6"})]},e.id)})})]}),t.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-900/90 backdrop-blur rounded-lg p-3 text-xs text-gray-300 max-w-xs",children:[t.jsx("p",{className:"font-semibold mb-1",children:"How to use:"}),t.jsxs("ul",{className:"space-y-0.5",children:[t.jsx("li",{children:"â€¢ Click nodes to select and view details"}),t.jsx("li",{children:"â€¢ Click outer ring to expand/collapse children"}),t.jsx("li",{children:"â€¢ ðŸŸ¡ Center = Main topic"}),t.jsx("li",{children:"â€¢ ðŸ”µ Branches = Key topics"}),t.jsx("li",{children:"â€¢ ðŸŸ¢ Leaves = Individual points"})]})]})]}),r&&t.jsxs("aside",{className:"w-80 bg-gray-800/50 backdrop-blur border-l border-gray-700 p-6 overflow-y-auto",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("span",{className:`inline-block px-2 py-  rounded text-xs font-semibold mb-2 ${r.type==="center"?"bg-yellow-600":r.type==="topic"?"bg-blue-600":"bg-green-600"}`,children:r.type.toUpperCase()}),t.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:r.label})]}),r.content&&t.jsx("div",{className:"bg-gray-900/50 rounded-lg p-4 mb-4",children:t.jsx("p",{className:"text-gray-300 leading-relaxed",children:r.content})}),r.children&&r.children.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wide mb-2",children:["Connected Nodes (",r.children.length,")"]}),t.jsx("ul",{className:"space-y-1.5",children:r.children.map(e=>{const s=a.find(l=>l.id===e);return s?t.jsx("li",{children:t.jsx("button",{onClick:()=>w(e),className:"w-full text-left px-3 py-2 rounded bg-gray-700/50 hover:bg-gray-700 transition text-sm text-gray-300 hover:text-white",children:s.label})},e):null})})]}),r.type==="center"&&t.jsxs("div",{className:"mt-6",children:[t.jsx("button",{onClick:()=>{const e=new Set(a.map(s=>s.id));m(e)},className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium mb-2",children:"Expand All"}),t.jsx("button",{onClick:()=>m(new Set(["center"])),className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium",children:"Collapse All"})]})]})]})]})};export{P as default};
